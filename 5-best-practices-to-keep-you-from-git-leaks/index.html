<!DOCTYPE html>
<html>
  
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">

    <title>How To Keep Safe From Git Leaks</title>

    
    
    <meta name="description" content="
 Countless developers are using Git for version control, but many don’t have enough knowledge about how Git works. Some people even use Git and Github as tools for backup files. This leads to ...">
    <link rel="canonical" href="http://coderscat.com/5-best-practices-to-keep-you-from-git-leaks/" />
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How To Keep Safe From Git Leaks">
    <meta property="og:description" content="
 Countless developers are using Git for version control, but many don’t have enough knowledge about how Git works. Some people even use Git and Github as tools for backup files. This leads to ...">
    <meta property="og:url" content="http://coderscat.com/5-best-practices-to-keep-you-from-git-leaks/" />
    <meta property="og:site_name" content="Coder's Cat">
    <meta property="article:publisher" content="https://www.facebook.com/coderscat">
    <meta property="article:tag" content="">
    <meta property="article:section" content="">
    <meta property="article:published_time" content="2020-04-05 23:43:00">
    <meta property="article:modified_time" content="2020-04-05 23:43:00">
    <meta property="og:updated_time" content="2020-04-05 23:43:00">
    <meta property="og:image" content="http://coderscat.com/images/clint-patterson-dYEuFB8KQJk-unsplash.jpg"/>
    <meta property="og:image:secure_url" content="http://coderscat.com/images/clint-patterson-dYEuFB8KQJk-unsplash.jpg"/>
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="400">
    <meta property="og:image:alt" content="CodersCat">
    <meta property="og:image:type" content="image/jpeg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How To Keep Safe From Git Leaks">
    <meta name="twitter:description" content="
 Countless developers are using Git for version control, but many don’t have enough knowledge about how Git works. Some people even use Git and Github as tools for backup files. This leads to ...">
    <meta name="twitter:site" content="@coderscat">
    <meta name="twitter:creator" content="@coderscat">
    <meta name="twitter:image" content="http://coderscat.com/images/clint-patterson-dYEuFB8KQJk-unsplash.jpg"/>



    <link rel="icon" type="image/png" sizes="32x32" href="/css/images/favicon-32x32.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/css/images/favicon-16x16.ico">

    <title>
        
            How To Keep Safe From Git Leaks | Coder&#39;s Cat
        
    </title>  
    
    
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/fonts.css">

    
<link rel="stylesheet" href="/css/plugins/code.css">

    
<link rel="stylesheet" href="/css/plugins/nprogress.min.css">

    <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">


    
<script src="/js/jquery.min.js"></script>

  <script type="text/javascript" src="/js/geopattern.min.js"></script>
  <script type="text/javascript" src="/js/nprogress.min.js"></script>


  <script type="text/javascript" async src="https://platform-api.sharethis.com/js/sharethis.js#property=5fa8f493be36290012aa2a0d&product=inline-share-buttons"></script>

  <div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
      <img src="/css/images/logo.png" width='400px' height='400px'/>
  </div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-77282254-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-77282254-2');
</script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Coder's Cat" type="application/atom+xml">
</head>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>Coder's Cat</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/data-structures/" class="item-link">D&S</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/algorithms/" class="item-link">Algo</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/programming-languages/" class="item-link">PL</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/system/" class="item-link">System</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tools/" class="item-link">Tools</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
      <li class="list-item" style="margin: 0">
       <a class="icon-small" href="/search">
        <span class="fa-stack fa-lg">
          <i class="fa fa-search fa-stack-1x fa-inverse"></i>
        </span>
       </a>
      </li>

      <li class="list-item" style="margin: 0">
        <a class="icon-small" href="/atom.xml">
         <span class="fa-stack fa-lg">
           <i class="fa fa-rss fa-inverse"></i>
         </span>
        </a>
       </li>
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/data-structures/" class="menu-link">D&S</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/algorithms/" class="menu-link">Algo</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/programming-languages/" class="menu-link">PL</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/system/" class="menu-link">System</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tools/" class="menu-link">Tools</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        


        <li class="list-item" style="margin: 0">
          <a class="icon-small" href="/search">
           <span class="fa-stack">
             <i class="fa fa-search"></i>
           </span>
          </a>
         </li>

         
      <li class="list-item" style="margin: 0">
        <a class="icon-small" href="/atom.xml">
         <span class="fa-stack fa-lg">
           <i id="rss-icon" class="fa fa-rss fa-inverse"></i>
         </span>
        </a>
       </li>

      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>How To Keep Safe From Git Leaks</h2>
  <p class="post-date">2020-04-05</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content">
      <p><img src="/images/clint-patterson-dYEuFB8KQJk-unsplash.jpg" alt="file:img/clint-patterson-dYEuFB8KQJk-unsplash.jpg"></p>
<p> Countless developers are using Git for version control, but many don’t have enough knowledge about how Git works. Some people even use Git and Github as tools for backup files. This leads to information disclosure in Git repositories. <a target="_blank" rel="noopener" href="https://www.zdnet.com/article/over-100000-github-repos-have-leaked-api-or-cryptographic-keys/">Thousands of new API or cryptographic keys leak via GitHub projects every day</a>.</p>
<p> I have been worked in the field of information security these three years. About two years ago, our company had a severe security issue triggered by the information leak a Git repository.</p>
<p> An employee accidentally leaked an AWS key to Github. The attacker used this key to download more sensitive data from our servers. We put a lot of time into fixing this issue, we tried to find out how much data leaked, analyzed the affected systems and related users, and replaced all the leaked keys in systems.</p>
<p> It is a sad story that any company and developer would not want to experience.</p>
<p> I won’t write more details about it. Instead, I hope more people know how to avoid it. Here are my suggestions for you to keep safe from Git leaks.</p>
<h2 id="Build-security-awareness"><a href="#Build-security-awareness" class="headerlink" title="Build security awareness"></a>Build security awareness</h2><p> Most junior developers don’t have enough security awareness. Some companies will train new employees, but some companies don’t have systematic training.</p>
<p> As a developer, we need to know which kind of data may introduce security issues. Remember these categories of data can not be checked into Git repository:</p>
<ul>
<li>Any configuration data, including password, API keys, AWS keys, private keys, etc.</li>
</ul>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Personal_data">Personally Identifiable Information</a> (PII). According to GDPR, if a company leaked the users’ PII, the company need to notify users, relevant departments and there will be more legal troubles.</p>
<p>If you are working for a company, don’t share any source code or data related to the company without permission.</p>
<p>Attackers can easily find some code with company copyright on GitHub, which was accidentally leaked to Github by some employees.</p>
<p>My advice is, try to distinguish between company affairs and personal stuff strictly.</p>
</li>
</ul>
<h2 id="Use-Git-ignore"><a href="#Use-Git-ignore" class="headerlink" title="Use Git ignore"></a>Use Git ignore</h2><p> When we create a new project with Git, we must set a <strong>.gitignore</strong> properly. <strong>gitignore</strong> is a Git configuration file that lists the files or directories that will not be checked into the Git repository.</p>
<p> The project’s <a target="_blank" rel="noopener" href="https://github.com/github/gitignore">gitignore</a> is a collection of useful .gitignore templates, with all kinds of programming language, framework, tool or environment.</p>
<p> We need to know the pattern matching rules of <strong>gitignore</strong> and add our own rules based on the templates.</p>
<p> <img src="/images/2020_04_01_how-to-fix-information-exposure-in-git-repo.org_20200406_001604.png" alt="file:img/2020_04_01_how-to-fix-information-exposure-in-git-repo.org_20200406_001604.png"></p>
<h2 id="Check-commits-with-Git-hooks-and-CI"><a href="#Check-commits-with-Git-hooks-and-CI" class="headerlink" title="Check commits with Git hooks and CI"></a>Check commits with Git hooks and CI</h2><p> No tools could find out all the sensitive data from a Git repository, but a couple of tools and practices can help.</p>
<p> <a target="_blank" rel="noopener" href="https://github.com/awslabs/git-secrets">git-secrets</a> and <a target="_blank" rel="noopener" href="https://github.com/thoughtworks/talisman">talisman</a> are similar tools, they are meant to be installed in local repositories as <a target="_blank" rel="noopener" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">pre-commit hooks</a>. Every change will be checked before committed, pre-commit hooks will reject the commit if they detect a prospective commit may contain sensitive information.</p>
<p> <a target="_blank" rel="noopener" href="https://github.com/zricethezav/gitleaks">gitleaks</a> provides another way to find unencrypted secrets and other unwanted data types in git repositories. We could integrate it into automation workflows such as CICD.</p>
<h2 id="Code-review"><a href="#Code-review" class="headerlink" title="Code review"></a>Code review</h2><p> Code review is a best practice for team working. All the teammates will learn from each other’s source code. Junior developer’s code should be reviewed by developers with more experience.</p>
<p> Most unintended changes can be found out during the code review stage.</p>
<p> <a target="_blank" rel="noopener" href="https://help.github.com/en/github/administering-a-repository/enabling-branch-restrictions">Enabling branch restrictions</a> can enforce branch restrictions so that only certain users can push to a protected branch in repositories. Gitlab has a similar option.</p>
<p> Setting master to a restricted branch helps us to enforce the code review workflow.</p>
<p> <img src="/images/2020_04_01_how-to-fix-information-exposure-in-git-repo.org_20200408_143912.png" alt="file:img/2020_04_01_how-to-fix-information-exposure-in-git-repo.org_20200408_143912.png"></p>
<h2 id="Fix-it-and-quickly-and-correctly"><a href="#Fix-it-and-quickly-and-correctly" class="headerlink" title="Fix it and quickly and correctly"></a>Fix it and quickly and correctly</h2><p> With all the above tools and mechanisms, errors still could happen. If we fix it quickly and correctly, the leak may introduce no actual security issue.</p>
<p> If we find some sensitive data leaked in the Git repository, we can not just make another commit to clean up.</p>
<p> <img src="/images/2020_04_01_how-to-fix-information-exposure-in-git-repo.org_20200408_145202.png" alt="file:img/2020_04_01_how-to-fix-information-exposure-in-git-repo.org_20200408_145202.png"></p>
<p> What we need to do is remove all the sensitive data from the entire Git history.</p>
<p><strong>Remember to backup before any cleanup, and then remove the backup clone after we confirmed everything is OK</strong>.</p>
<p> Use the <code>--mirror</code> to clone a bare repository; this is a full copy of the Git database.</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> --mirror git://example.com/need-clean-repo.git<br></code></pre></td></tr></table></figure>



<p>We need <strong>git filter-branch</strong> to remove data from all branches and commit histories. Suppose we want to remove <code>./config/passwd</code> from Git:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ git filter-branch --force --index-filter \<br>  <span class="hljs-string">&#x27;git rm --cached --ignore-unmatch ./config/password&#x27;</span> \<br>  --prune-empty --tag-name-filter cat -- --all<br></code></pre></td></tr></table></figure>

<p> Remember to add the sensitive file to .gitignore:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;./config/password&quot;</span> &gt;&gt; .gitignore<br>$ git add .gitignore<br>$ git commit -m <span class="hljs-string">&quot;Add password to .gitignore&quot;</span><br></code></pre></td></tr></table></figure>

<p> Then we push all branches to remote:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ git push --force --all<br>$ git push --force --tags<br></code></pre></td></tr></table></figure>

<p> Tell our collaborators to rebase:</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ git rebase<br></code></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="https://rtyley.github.io/bfg-repo-cleaner/">BFG</a> is a faster and simpler alternative to <strong>git filter-branch</strong> for removing sensitive data. It’s usually 10 - 720x faster than <strong>git filter-branch</strong>. Except for deleting files, BFG could also be used to replace secrets in files.</p>
<p> <code>BFG</code> will leave the latest commit untouched. It’s designed to protect us from making mistakes. We should explicitly delete the file, commit the deletion, then clean up the history to remove it.</p>
<p> If the leaked Git repository is forked by others, we need to follow the <a target="_blank" rel="noopener" href="https://help.github.com/en/github/site-policy/dmca-takedown-policy#c-what-if-i-inadvertently-missed-the-window-to-make-changes">DMCA Takedown Policy</a> to ask Github to remove the forked repositories.</p>
<p> The whole procedure requires some time to finish, but it’s the only way to remove all the copies.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p> Don’t make the same mistakes that countless people have made. Try to put some effort to avoid safety accidents.</p>
<p> Use these tools and strategies will help much in avoiding Git leaks.</p>

    </section>

     <div>
          <p style="text-align:center; color: #12472d; margin-left: 2%; margin-right: 2%;"><b>Join my <a target="_blank" rel="noopener" href="http://codercat.substack.com">Email List</a> for more insights, It's Free!&#128523;	</b></p>
          <iframe src="https://codercat.substack.com/embed" width="96%" height="350" style="border:2px solid #EEE; background:rgb(248, 244, 244); margin-left: 2%; margin-right: 2%;" frameborder="1" scrolling="no"></iframe>
      </div>
    
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#Misc" >
    <span class="tag-code-index">Misc</span>
  </a>


      </div>
    

    <div class="sharethis-inline-share-buttons"></div>

    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/why-redis-is-single-threaded/">
        <span class="nav-arrow">← </span>
        
          Why Redis is Single-Threaded
        
      </a>
    
    
        <a class="nav-right" href="/how-redis-expire-key/">
            
                How Redis expire Key
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>


    <!-- NAV END -->

    <script src="https://utteranc.es/client.js"
            repo="nickmose8/coderscat-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>

  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
      <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title"></strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Build-security-awareness"><span class="toc-nav-text">Build security awareness</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Use-Git-ignore"><span class="toc-nav-text">Use Git ignore</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Check-commits-with-Git-hooks-and-CI"><span class="toc-nav-text">Check commits with Git hooks and CI</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Code-review"><span class="toc-nav-text">Code review</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Fix-it-and-quickly-and-correctly"><span class="toc-nav-text">Fix it and quickly and correctly</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Conclusion"><span class="toc-nav-text">Conclusion</span></a></li></ol>
    
  </div>
</aside>

  
  <!-- Catalog END -->

</main>




<script>
  (function () {
    var url = 'http://coderscat.com/5-best-practices-to-keep-you-from-git-leaks/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer" id="footer">
    <p class="copyright">
        &copy; 2022 | CodersCat
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
 var hasLine = 'false';
 async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
     $('figure pre').each(function(i, block) {
         var figure = $(this).parents('figure');
         if (hasLine === 'false') {
             figure.find('.gutter').hide();
         }
         var lang = figure.attr('class').split(' ')[1] || 'code';
         var codeHtml = $(this).html();
         var codeTag = document.createElement('code');
         codeTag.className = lang;
         codeTag.innerHTML = codeHtml;
         $(this).attr('class', '').empty().html(codeTag);
         figure.attr('data-lang', lang.toUpperCase());
     });
 })
</script>

<script src="/js/script.js"></script>


  </body>
</html>